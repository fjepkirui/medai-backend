"0",""
"0","# Merge the Book and Rating(rating_pgA) dataset by ISBN"
"0","NewData <- inner_join(rating_pgA, Book, by = ""ISBN"")"
"0",""
"0","#  average rating for each publisher"
"0","avg_rating <- tapply(NewData$Book.Rating, NewData$Publisher, mean, na.rm = TRUE)"
"0",""
"0","#  number of ratings for each publisher"
"0","count_r <- tapply(NewData$Book.Rating, NewData$Publisher, length)"
"0",""
"0","#  Combine the results into a data frame"
"0","Avg_Rating <- data.frame("
"0","  Publisher = names(avg_rating),"
"0","  AverageRating = as.numeric(avg_rating),"
"0","  RatingCount = as.numeric(count_r),"
"0","  stringsAsFactors = FALSE"
"0",")"
"0",""
"0","#  fixing encoding in publisher column"
"0","Avg_Rating$Publisher <- iconv(Avg_Rating$Publisher, from = ""ISO-8859-1"", to = ""UTF-8"", sub = """")"
"0",""
"0",""
"0","# top 20 publishers in descending order by rating counts"
"0","publisher20 <- Avg_Rating %>%"
"0","  arrange(desc(RatingCount)) %>%"
"0","  head(20)"
"0",""
"0","# using kable to show table for to 20 publishers"
"0","publisher20 %>%"
"0","  kable(""html"", col.names = c(""Publisher"", ""Average Rating"", ""Rating Count"")) %>%"
"0","  kable_styling("
"0","    full_width = FALSE,"
"0","    bootstrap_options = c(""striped"", ""hover"", ""condensed"")"
"0","  )"
