"0",""
"0","#  Replace NA values with the median age"
"0","median_age <- median(User$Age, na.rm = TRUE)"
"0","User$Age[is.na(User$Age)] <- median_age"
"0",""
"0","#  Merge User data with ratings and filter books published after 2000"
"0","Book_PGA <- merge(rating_pgA, Book, by = ""ISBN"")"
"0","Book_PGB <- merge(rating_pgB, Book, by = ""ISBN"")"
"0",""
"0","User_PGA1 <- merge(Book_PGA, User, by = ""User.ID"", all.x = TRUE)"
"0","User_PGB1 <- merge(Book_PGB, User, by = ""User.ID"", all.x = TRUE)"
"0",""
"0","#  Filter only books published after 2000"
"0","PGA1_2000 <- subset(User_PGA1, Year.Of.Publication > 2000)"
"0","PGB1_2000 <- subset(User_PGB1, Year.Of.Publication > 2000)"
"0",""
"0","# Create age groups for PGA and PGB"
"0","PGA1_2000$AgeGroup <- cut("
"0"," PGA1_2000$Age,"
"0","  breaks = c(-Inf, 18, 30, 45, 60, Inf),"
"0","  labels = c(""0-18"", ""19-30"", ""31-45"", ""46-60"", ""61+"")"
"0",")"
"0",""
"0","PGB1_2000$AgeGroup <- cut("
"0","  PGB1_2000$Age,"
"0","  breaks = c(-Inf, 18, 30, 45, 60, Inf),"
"0","  labels = c(""0-18"", ""19-30"", ""31-45"", ""46-60"", ""61+"")"
"0",")"
"0",""
"0","#  Calculate average ratings by age group for both datasets"
"0","avg_rating_age_PGA <- aggregate(Book.Rating ~ AgeGroup, data = PGA1_2000, FUN = mean)"
"0","avg_rating_age_PGB <- aggregate(Book.Rating ~ AgeGroup, data = PGB1_2000, FUN = mean)"
"0",""
"0","#  Combine the average ratings for both datasets into one data frame"
"0","age_ratings <- rbind("
"0","  data.frame(AgeGroup = avg_rating_age_PGA$AgeGroup, Rating = avg_rating_age_PGA$Book.Rating, Dataset = ""PGA""),"
"0","  data.frame(AgeGroup = avg_rating_age_PGB$AgeGroup, Rating = avg_rating_age_PGB$Book.Rating, Dataset = ""PGB"")"
"0",")"
"0",""
"0","#  Print the combined age ratings"
"0","print(age_ratings)"
